import{e as te,f as _e,L as qt,U as xe,C as Ae,M as Ht,h as U,N as Se,O as pt,j as Rt,Q as jt,i as Ut,E as Wt,w as Zt,r as Yt,v as we,q as Gt,c as _t}from"./msgTip-a00a6396.js";import{f as de,g as ae,an as qe,E as ke,aA as vt,Q as Je,ab as Jt,a0 as ve,h as T,_ as ge,av as G,m as C,n as q,G as J,B as R,C as Z,K as X,v as L,J as ue,q as re,r as $,R as fe,H as Qt,I as ie,a2 as Qe,aJ as He,as as Re,ae as Xt,b as gt,d as be,N as en,$ as Ne,ac as yt,l as _,bx as tn,o as Xe,V as ce,i as kt,af as nn,e as sn,O as an,ai as on,aj as ln,by as rn,D as he,u as N,x as mt,aq as dn,al as cn,a as un,t as hn,ah as je,M as fn,bq as Ve,bo as pn,bz as vn,L as gn,F as yn,s as ot,aZ as kn,Z as mn,bA as Nn}from"./index-d45ed081.js";import{E as Nt,u as Cn,a as lt}from"./index-6998b886.js";import{b as bn,E as Ct,i as Ee}from"./index-184e15d9.js";import{E as En}from"./index-83c7d896.js";import{c as rt}from"./strings-5238cde9.js";import{u as dt,c as it}from"./arrays-e667dc24.js";import{b as wn}from"./index-ae57328d.js";import{t as Dn,E as ct}from"./index-151d4a8e.js";import{d as Sn,C as Kn}from"./index-b06f2c24.js";import{_ as $n}from"./index-a9d2ad06.js";var Tn=1,Ln=4;function bt(e){return wn(e,Tn|Ln)}var xn=1/0;function An(e){var t=e==null?0:e.length;return t?bn(e,xn):[]}const Mn=()=>Math.floor(Math.random()*1e4);var In=de({name:"NodeContent",setup(){return{ns:ae("cascader-node")}},render(){const{ns:e}=this,{node:t,panel:n}=this.$parent,{data:a,label:s}=t,{renderLabelFn:o}=n;return qe("span",{class:e.e("label")},o?o({node:t,data:a}):s)}});const et=Symbol(),Pn=de({name:"ElCascaderNode",components:{ElCheckbox:Ct,ElRadio:En,NodeContent:In,ElIcon:ke,Check:vt,Loading:Je,ArrowRight:Jt},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:t}){const n=ve(et),a=ae("cascader-node"),s=T(()=>n.isHoverMenu),o=T(()=>n.config.multiple),l=T(()=>n.config.checkStrictly),d=T(()=>{var D;return(D=n.checkedNodes[0])==null?void 0:D.uid}),c=T(()=>e.node.isDisabled),g=T(()=>e.node.isLeaf),v=T(()=>l.value&&!g.value||!c.value),f=T(()=>m(n.expandingNode)),u=T(()=>l.value&&n.checkedNodes.some(m)),m=D=>{var F;const{level:Y,uid:k}=e.node;return((F=D==null?void 0:D.pathNodes[Y-1])==null?void 0:F.uid)===k},b=()=>{f.value||n.expandNode(e.node)},A=D=>{const{node:F}=e;D!==F.checked&&n.handleCheckChange(F,D)},w=()=>{n.lazyLoad(e.node,()=>{g.value||b()})},I=D=>{s.value&&(P(),!g.value&&t("expand",D))},P=()=>{const{node:D}=e;!v.value||D.loading||(D.loaded?b():w())},W=()=>{s.value&&!g.value||(g.value&&!c.value&&!l.value&&!o.value?M(!0):P())},H=D=>{l.value?(A(D),e.node.loaded&&b()):M(D)},M=D=>{e.node.loaded?(A(D),!l.value&&b()):w()};return{panel:n,isHoverMenu:s,multiple:o,checkStrictly:l,checkedNodeId:d,isDisabled:c,isLeaf:g,expandable:v,inExpandingPath:f,inCheckedPath:u,ns:a,handleHoverExpand:I,handleExpand:P,handleClick:W,handleCheck:M,handleSelectCheck:H}}}),Bn=["id","aria-haspopup","aria-owns","aria-expanded","tabindex"],On=re("span",null,null,-1);function zn(e,t,n,a,s,o){const l=G("el-checkbox"),d=G("el-radio"),c=G("check"),g=G("el-icon"),v=G("node-content"),f=G("loading"),u=G("arrow-right");return C(),q("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?null:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:L([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:t[2]||(t[2]=(...m)=>e.handleHoverExpand&&e.handleHoverExpand(...m)),onFocus:t[3]||(t[3]=(...m)=>e.handleHoverExpand&&e.handleHoverExpand(...m)),onClick:t[4]||(t[4]=(...m)=>e.handleClick&&e.handleClick(...m))},[J(" prefix "),e.multiple?(C(),R(l,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:t[0]||(t[0]=te(()=>{},["stop"])),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onUpdate:modelValue"])):e.checkStrictly?(C(),R(d,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:t[1]||(t[1]=te(()=>{},["stop"]))},{default:Z(()=>[J(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),On]),_:1},8,["model-value","label","disabled","onUpdate:modelValue"])):e.isLeaf&&e.node.checked?(C(),R(g,{key:2,class:L(e.ns.e("prefix"))},{default:Z(()=>[X(c)]),_:1},8,["class"])):J("v-if",!0),J(" content "),X(v),J(" postfix "),e.isLeaf?J("v-if",!0):(C(),q(ue,{key:3},[e.node.loading?(C(),R(g,{key:0,class:L([e.ns.is("loading"),e.ns.e("postfix")])},{default:Z(()=>[X(f)]),_:1},8,["class"])):(C(),R(g,{key:1,class:L(["arrow-right",e.ns.e("postfix")])},{default:Z(()=>[X(u)]),_:1},8,["class"]))],64))],42,Bn)}var Fn=ge(Pn,[["render",zn],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/node.vue"]]);const Vn=de({name:"ElCascaderMenu",components:{Loading:Je,ElIcon:ke,ElScrollbar:Nt,ElCascaderNode:Fn},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const t=Qe(),n=ae("cascader-menu"),{t:a}=_e(),s=Mn();let o=null,l=null;const d=ve(et),c=$(null),g=T(()=>!e.nodes.length),v=T(()=>!d.initialLoaded),f=T(()=>`cascader-menu-${s}-${e.index}`),u=w=>{o=w.target},m=w=>{if(!(!d.isHoverMenu||!o||!c.value))if(o.contains(w.target)){b();const I=t.vnode.el,{left:P}=I.getBoundingClientRect(),{offsetWidth:W,offsetHeight:H}=I,M=w.clientX-P,D=o.offsetTop,F=D+o.offsetHeight;c.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${M} ${D} L${W} 0 V${D} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${M} ${F} L${W} ${H} V${F} Z" />
        `}else l||(l=window.setTimeout(A,d.config.hoverThreshold))},b=()=>{l&&(clearTimeout(l),l=null)},A=()=>{c.value&&(c.value.innerHTML="",b())};return{ns:n,panel:d,hoverZone:c,isEmpty:g,isLoading:v,menuId:f,t:a,handleExpand:u,handleMouseMove:m,clearHoverZone:A}}});function qn(e,t,n,a,s,o){const l=G("el-cascader-node"),d=G("loading"),c=G("el-icon"),g=G("el-scrollbar");return C(),R(g,{key:e.menuId,tag:"ul",role:"menu",class:L(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:Z(()=>{var v;return[(C(!0),q(ue,null,fe(e.nodes,f=>(C(),R(l,{key:f.uid,node:f,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),e.isLoading?(C(),q("div",{key:0,class:L(e.ns.e("empty-text"))},[X(c,{size:"14",class:L(e.ns.is("loading"))},{default:Z(()=>[X(d)]),_:1},8,["class"]),Qt(" "+ie(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(C(),q("div",{key:1,class:L(e.ns.e("empty-text"))},ie(e.t("el.cascader.noData")),3)):(v=e.panel)!=null&&v.isHoverMenu?(C(),q("svg",{key:2,ref:"hoverZone",class:L(e.ns.e("hover-zone"))},null,2)):J("v-if",!0)]}),_:1},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var Hn=ge(Vn,[["render",qn],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/menu.vue"]]);let Rn=0;const jn=e=>{const t=[e];let{parent:n}=e;for(;n;)t.unshift(n),n=n.parent;return t};let Ue=class We{constructor(t,n,a,s=!1){this.data=t,this.config=n,this.parent=a,this.root=s,this.uid=Rn++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:o,label:l,children:d}=n,c=t[d],g=jn(this);this.level=s?0:a?a.level+1:1,this.value=t[o],this.label=t[l],this.pathNodes=g,this.pathValues=g.map(v=>v.value),this.pathLabels=g.map(v=>v.label),this.childrenData=c,this.children=(c||[]).map(v=>new We(v,n,this)),this.loaded=!n.lazy||this.isLeaf||!He(c)}get isDisabled(){const{data:t,parent:n,config:a}=this,{disabled:s,checkStrictly:o}=a;return(Re(s)?s(t,this):!!t[s])||!o&&(n==null?void 0:n.isDisabled)}get isLeaf(){const{data:t,config:n,childrenData:a,loaded:s}=this,{lazy:o,leaf:l}=n,d=Re(l)?l(t,this):t[l];return Xt(d)?o&&!s?!1:!(Array.isArray(a)&&a.length):!!d}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(t){const{childrenData:n,children:a}=this,s=new We(t,this.config,this);return Array.isArray(n)?n.push(t):this.childrenData=[t],a.push(s),s}calcText(t,n){const a=t?this.pathLabels.join(n):this.label;return this.text=a,a}broadcast(t,...n){const a=`onParent${rt(t)}`;this.children.forEach(s=>{s&&(s.broadcast(t,...n),s[a]&&s[a](...n))})}emit(t,...n){const{parent:a}=this,s=`onChild${rt(t)}`;a&&(a[s]&&a[s](...n),a.emit(t,...n))}onParentCheck(t){this.isDisabled||this.setCheckState(t)}onChildCheck(){const{children:t}=this,n=t.filter(s=>!s.isDisabled),a=n.length?n.every(s=>s.checked):!1;this.setCheckState(a)}setCheckState(t){const n=this.children.length,a=this.children.reduce((s,o)=>{const l=o.checked?1:o.indeterminate?.5:0;return s+l},0);this.checked=this.loaded&&this.children.filter(s=>!s.isDisabled).every(s=>s.loaded&&s.checked)&&t,this.indeterminate=this.loaded&&a!==n&&a>0}doCheck(t){if(this.checked===t)return;const{checkStrictly:n,multiple:a}=this.config;n||!a?this.checked=t:(this.broadcast("check",t),this.setCheckState(t),this.emit("check"))}};const Ze=(e,t)=>e.reduce((n,a)=>(a.isLeaf?n.push(a):(!t&&n.push(a),n=n.concat(Ze(a.children,t))),n),[]);class ut{constructor(t,n){this.config=n;const a=(t||[]).map(s=>new Ue(s,this.config));this.nodes=a,this.allNodes=Ze(a,!1),this.leafNodes=Ze(a,!0)}getNodes(){return this.nodes}getFlattedNodes(t){return t?this.leafNodes:this.allNodes}appendNode(t,n){const a=n?n.appendChild(t):new Ue(t,this.config);n||this.nodes.push(a),this.allNodes.push(a),a.isLeaf&&this.leafNodes.push(a)}appendNodes(t,n){t.forEach(a=>this.appendNode(a,n))}getNodeByValue(t,n=!1){return!t&&t!==0?null:this.getFlattedNodes(n).find(s=>Ee(s.value,t)||Ee(s.pathValues,t))||null}getSameNode(t){return t&&this.getFlattedNodes(!1).find(({value:a,level:s})=>Ee(t.value,a)&&t.level===s)||null}}const Et=gt({modelValue:{type:be([Number,String,Array])},options:{type:be(Array),default:()=>[]},props:{type:be(Object),default:()=>({})}}),Un={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:en,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},Wn=e=>T(()=>({...Un,...e.props})),ht=e=>{if(!e)return 0;const t=e.id.split("-");return Number(t[t.length-2])},Zn=e=>{if(!e)return;const t=e.querySelector("input");t?t.click():qt(e)&&e.click()},Yn=(e,t)=>{const n=t.slice(0),a=n.map(o=>o.uid),s=e.reduce((o,l)=>{const d=a.indexOf(l.uid);return d>-1&&(o.push(l),n.splice(d,1),a.splice(d,1)),o},[]);return s.push(...n),s},Gn=de({name:"ElCascaderPanel",components:{ElCascaderMenu:Hn},props:{...Et,border:{type:Boolean,default:!0},renderLabel:Function},emits:[xe,Ae,"close","expand-change"],setup(e,{emit:t,slots:n}){let a=!1;const s=ae("cascader"),o=Wn(e);let l=null;const d=$(!0),c=$([]),g=$(null),v=$([]),f=$(null),u=$([]),m=T(()=>o.value.expandTrigger==="hover"),b=T(()=>e.renderLabel||n.default),A=()=>{const{options:p}=e,S=o.value;a=!1,l=new ut(p,S),v.value=[l.getNodes()],S.lazy&&He(e.options)?(d.value=!1,w(void 0,K=>{K&&(l=new ut(K,S),v.value=[l.getNodes()]),d.value=!0,Y(!1,!0)})):Y(!1,!0)},w=(p,S)=>{const K=o.value;p=p||new Ue({},K,void 0,!0),p.loading=!0;const x=O=>{const i=p,E=i.root?null:i;O&&(l==null||l.appendNodes(O,E)),i.loading=!1,i.loaded=!0,i.childrenData=i.childrenData||[],S&&S(O)};K.lazyLoad(p,x)},I=(p,S)=>{var K;const{level:x}=p,O=v.value.slice(0,x);let i;p.isLeaf?i=p.pathNodes[x-2]:(i=p,O.push(p.children)),((K=f.value)==null?void 0:K.uid)!==(i==null?void 0:i.uid)&&(f.value=p,v.value=O,!S&&t("expand-change",(p==null?void 0:p.pathValues)||[]))},P=(p,S,K=!0)=>{const{checkStrictly:x,multiple:O}=o.value,i=u.value[0];a=!0,!O&&(i==null||i.doCheck(!1)),p.doCheck(S),F(),K&&!O&&!x&&t("close"),!K&&!O&&!x&&W(p)},W=p=>{p&&(p=p.parent,W(p),p&&I(p))},H=p=>l==null?void 0:l.getFlattedNodes(p),M=p=>{var S;return(S=H(p))==null?void 0:S.filter(K=>K.checked!==!1)},D=()=>{u.value.forEach(p=>p.doCheck(!1)),F()},F=()=>{var p;const{checkStrictly:S,multiple:K}=o.value,x=u.value,O=M(!S),i=Yn(x,O),E=i.map(V=>V.valueByOption);u.value=i,g.value=K?E:(p=E[0])!=null?p:null},Y=(p=!1,S=!1)=>{const{modelValue:K}=e,{lazy:x,multiple:O,checkStrictly:i}=o.value,E=!i;if(!(!d.value||a||!S&&Ee(K,g.value)))if(x&&!p){const Q=dt(An(it(K))).map(ne=>l==null?void 0:l.getNodeByValue(ne)).filter(ne=>!!ne&&!ne.loaded&&!ne.loading);Q.length?Q.forEach(ne=>{w(ne,()=>Y(!1,S))}):Y(!0,S)}else{const V=O?it(K):[K],Q=dt(V.map(ne=>l==null?void 0:l.getNodeByValue(ne,E)));k(Q,S),g.value=bt(K)}},k=(p,S=!0)=>{const{checkStrictly:K}=o.value,x=u.value,O=p.filter(V=>!!V&&(K||V.isLeaf)),i=l==null?void 0:l.getSameNode(f.value),E=S&&i||O[0];E?E.pathNodes.forEach(V=>I(V,!0)):f.value=null,x.forEach(V=>V.doCheck(!1)),O.forEach(V=>V.doCheck(!0)),u.value=O,ce(B)},B=()=>{kt&&c.value.forEach(p=>{const S=p==null?void 0:p.$el;if(S){const K=S.querySelector(`.${s.namespace.value}-scrollbar__wrap`),x=S.querySelector(`.${s.b("node")}.${s.is("active")}`)||S.querySelector(`.${s.b("node")}.in-active-path`);Ht(K,x)}})},j=p=>{const S=p.target,{code:K}=p;switch(K){case U.up:case U.down:{p.preventDefault();const x=K===U.up?-1:1;Se(pt(S,x,`.${s.b("node")}[tabindex="-1"]`));break}case U.left:{p.preventDefault();const x=c.value[ht(S)-1],O=x==null?void 0:x.$el.querySelector(`.${s.b("node")}[aria-expanded="true"]`);Se(O);break}case U.right:{p.preventDefault();const x=c.value[ht(S)+1],O=x==null?void 0:x.$el.querySelector(`.${s.b("node")}[tabindex="-1"]`);Se(O);break}case U.enter:Zn(S);break}};return Ne(et,yt({config:o,expandingNode:f,checkedNodes:u,isHoverMenu:m,initialLoaded:d,renderLabelFn:b,lazyLoad:w,expandNode:I,handleCheckChange:P})),_([o,()=>e.options],A,{deep:!0,immediate:!0}),_(()=>e.modelValue,()=>{a=!1,Y()},{deep:!0}),_(()=>g.value,p=>{Ee(p,e.modelValue)||(t(xe,p),t(Ae,p))}),tn(()=>c.value=[]),Xe(()=>!He(e.modelValue)&&Y()),{ns:s,menuList:c,menus:v,checkedNodes:u,handleKeyDown:j,handleCheckChange:P,getFlattedNodes:H,getCheckedNodes:M,clearCheckedNodes:D,calculateCheckedValue:F,scrollToExpandingNode:B}}});function _n(e,t,n,a,s,o){const l=G("el-cascader-menu");return C(),q("div",{class:L([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:t[0]||(t[0]=(...d)=>e.handleKeyDown&&e.handleKeyDown(...d))},[(C(!0),q(ue,null,fe(e.menus,(d,c)=>(C(),R(l,{key:c,ref_for:!0,ref:g=>e.menuList[c]=g,index:c,nodes:[...d]},null,8,["index","nodes"]))),128))],34)}var Ke=ge(Gn,[["render",_n],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/index.vue"]]);Ke.install=e=>{e.component(Ke.name,Ke)};const wt=Ke,xs=wt,Jn=gt({...Et,size:nn,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:be(Function),default:(e,t)=>e.text.includes(t)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:be(Function),default:()=>!0},popperClass:{type:String,default:""},teleported:Cn.teleported,tagType:{...Dn.type,default:"info"},validateEvent:{type:Boolean,default:!0}}),Qn={[xe]:e=>!!e||e===null,[Ae]:e=>!!e||e===null,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,visibleChange:e=>sn(e),expandChange:e=>!!e,removeTag:e=>!!e},Xn={key:0},es=["placeholder","onKeydown"],ts=["onClick"],ns="ElCascader",ss=de({name:ns}),as=de({...ss,props:Jn,emits:Qn,setup(e,{expose:t,emit:n}){const a=e,s={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:r})=>{const{modifiersData:h,placement:y}=r;["right","left","bottom","top"].includes(y)||(h.arrow.x=35)},requires:["arrow"]}]},o=an();let l=0,d=0;const c=ae("cascader"),g=ae("input"),{t:v}=_e(),{form:f,formItem:u}=on(),m=$(null),b=$(null),A=$(null),w=$(null),I=$(null),P=$(!1),W=$(!1),H=$(!1),M=$(""),D=$(""),F=$([]),Y=$([]),k=$([]),B=$(!1),j=T(()=>o.style),p=T(()=>a.disabled||(f==null?void 0:f.disabled)),S=T(()=>a.placeholder||v("el.cascader.placeholder")),K=T(()=>D.value||F.value.length>0||B.value?"":S.value),x=ln(),O=T(()=>["small"].includes(x.value)?"small":"default"),i=T(()=>!!a.props.multiple),E=T(()=>!a.filterable||i.value),V=T(()=>i.value?D.value:M.value),Q=T(()=>{var r;return((r=w.value)==null?void 0:r.checkedNodes)||[]}),ne=T(()=>!a.clearable||p.value||H.value||!W.value?!1:!!Q.value.length),Me=T(()=>{const{showAllLevels:r,separator:h}=a,y=Q.value;return y.length?i.value?"":y[0].calcText(r,h):""}),Ie=T({get(){return bt(a.modelValue)},set(r){n(xe,r),n(Ae,r),a.validateEvent&&(u==null||u.validate("change").catch(h=>Rt()))}}),nt=T(()=>{var r,h;return(h=(r=m.value)==null?void 0:r.popperRef)==null?void 0:h.contentRef}),Kt=T(()=>[c.b(),c.m(x.value),c.is("disabled",p.value),o.class]),$t=T(()=>[g.e("icon"),"icon-arrow-down",c.is("reverse",P.value)]),ee=r=>{var h,y,z;p.value||(r=r??!P.value,r!==P.value&&(P.value=r,(y=(h=b.value)==null?void 0:h.input)==null||y.setAttribute("aria-expanded",`${r}`),r?(Ce(),ce((z=w.value)==null?void 0:z.scrollToExpandingNode)):a.filterable&&ze(),n("visibleChange",r)))},Ce=()=>{ce(()=>{var r;(r=m.value)==null||r.updatePopper()})},Pe=()=>{H.value=!1},Be=r=>{const{showAllLevels:h,separator:y}=a;return{node:r,key:r.uid,text:r.calcText(h,y),hitState:!1,closable:!p.value&&!r.isDisabled,isCollapseTag:!1}},Oe=r=>{var h;const y=r.node;y.doCheck(!1),(h=w.value)==null||h.calculateCheckedValue(),n("removeTag",y.valueByOption)},Tt=()=>{if(!i.value)return;const r=Q.value,h=[],y=[];if(r.forEach(z=>y.push(Be(z))),Y.value=y,r.length){const[z,...oe]=r,le=oe.length;h.push(Be(z)),le&&(a.collapseTags?h.push({key:-1,text:`+ ${le}`,closable:!1,isCollapseTag:!0}):oe.forEach(se=>h.push(Be(se))))}F.value=h},st=()=>{var r,h;const{filterMethod:y,showAllLevels:z,separator:oe}=a,le=(h=(r=w.value)==null?void 0:r.getFlattedNodes(!a.props.checkStrictly))==null?void 0:h.filter(se=>se.isDisabled?!1:(se.calcText(z,oe),y(se,V.value)));i.value&&(F.value.forEach(se=>{se.hitState=!1}),Y.value.forEach(se=>{se.hitState=!1})),H.value=!0,k.value=le,Ce()},Lt=()=>{var r;let h;H.value&&I.value?h=I.value.$el.querySelector(`.${c.e("suggestion-item")}`):h=(r=w.value)==null?void 0:r.$el.querySelector(`.${c.b("node")}[tabindex="-1"]`),h&&(h.focus(),!H.value&&h.click())},at=()=>{var r,h;const y=(r=b.value)==null?void 0:r.input,z=A.value,oe=(h=I.value)==null?void 0:h.$el;if(!(!kt||!y)){if(oe){const le=oe.querySelector(`.${c.e("suggestion-list")}`);le.style.minWidth=`${y.offsetWidth}px`}if(z){const{offsetHeight:le}=z,se=F.value.length>0?`${Math.max(le+6,l)}px`:`${l}px`;y.style.height=se,Ce()}}},xt=r=>{var h;return(h=w.value)==null?void 0:h.getCheckedNodes(r)},At=r=>{Ce(),n("expandChange",r)},ye=r=>{var h;const y=(h=r.target)==null?void 0:h.value;if(r.type==="compositionend")B.value=!1,ce(()=>Fe(y));else{const z=y[y.length-1]||"";B.value=!Gt(z)}},Mt=r=>{if(!B.value)switch(r.code){case U.enter:ee();break;case U.down:ee(!0),ce(Lt),r.preventDefault();break;case U.esc:P.value===!0&&(r.preventDefault(),r.stopPropagation(),ee(!1));break;case U.tab:ee(!1);break}},It=()=>{var r;(r=w.value)==null||r.clearCheckedNodes(),!P.value&&a.filterable&&ze(),ee(!1)},ze=()=>{const{value:r}=Me;M.value=r,D.value=r},Pt=r=>{var h,y;const{checked:z}=r;i.value?(h=w.value)==null||h.handleCheckChange(r,!z,!1):(!z&&((y=w.value)==null||y.handleCheckChange(r,!0,!1)),ee(!1))},Bt=r=>{const h=r.target,{code:y}=r;switch(y){case U.up:case U.down:{const z=y===U.up?-1:1;Se(pt(h,z,`.${c.e("suggestion-item")}[tabindex="-1"]`));break}case U.enter:h.click();break}},Ot=()=>{const r=F.value,h=r[r.length-1];d=D.value?0:d+1,!(!h||!d||a.collapseTags&&r.length>1)&&(h.hitState?Oe(h):h.hitState=!0)},zt=r=>{n("focus",r)},Ft=r=>{n("blur",r)},Vt=Sn(()=>{const{value:r}=V;if(!r)return;const h=a.beforeFilter(r);rn(h)?h.then(st).catch(()=>{}):h!==!1?st():Pe()},a.debounce),Fe=(r,h)=>{!P.value&&ee(!0),!(h!=null&&h.isComposing)&&(r?Vt():Pe())};return _(H,Ce),_([Q,p],Tt),_(F,()=>{ce(()=>at())}),_(Me,ze,{immediate:!0}),Xe(()=>{const r=b.value.input,h=Number.parseFloat(jt(g.cssVarName("input-height"),r).value)-2;l=r.offsetHeight||h,Ut(r,at)}),t({getCheckedNodes:xt,cascaderPanelRef:nt}),(r,h)=>(C(),R(N(lt),{ref_key:"tooltipRef",ref:m,visible:P.value,teleported:r.teleported,"popper-class":[N(c).e("dropdown"),r.popperClass],"popper-options":s,"fallback-placements":["bottom-start","bottom","top-start","top","right","left"],"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:"bottom-start",transition:`${N(c).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:"",onHide:Pe},{default:Z(()=>[he((C(),q("div",{class:L(N(Kt)),style:mt(N(j)),onClick:h[5]||(h[5]=()=>ee(N(E)?void 0:!0)),onKeydown:Mt,onMouseenter:h[6]||(h[6]=y=>W.value=!0),onMouseleave:h[7]||(h[7]=y=>W.value=!1)},[X(N(Wt),{ref_key:"input",ref:b,modelValue:M.value,"onUpdate:modelValue":h[1]||(h[1]=y=>M.value=y),placeholder:N(K),readonly:N(E),disabled:N(p),"validate-event":!1,size:N(x),class:L(N(c).is("focus",P.value)),onCompositionstart:ye,onCompositionupdate:ye,onCompositionend:ye,onFocus:zt,onBlur:Ft,onInput:Fe},{suffix:Z(()=>[N(ne)?(C(),R(N(ke),{key:"clear",class:L([N(g).e("icon"),"icon-circle-close"]),onClick:te(It,["stop"])},{default:Z(()=>[X(N(dn))]),_:1},8,["class","onClick"])):(C(),R(N(ke),{key:"arrow-down",class:L(N($t)),onClick:h[0]||(h[0]=te(y=>ee(),["stop"]))},{default:Z(()=>[X(N(cn))]),_:1},8,["class"]))]),_:1},8,["modelValue","placeholder","readonly","disabled","size","class"]),N(i)?(C(),q("div",{key:0,ref_key:"tagWrapper",ref:A,class:L(N(c).e("tags"))},[(C(!0),q(ue,null,fe(F.value,y=>(C(),R(N(ct),{key:y.key,type:r.tagType,size:N(O),hit:y.hitState,closable:y.closable,"disable-transitions":"",onClose:z=>Oe(y)},{default:Z(()=>[y.isCollapseTag===!1?(C(),q("span",Xn,ie(y.text),1)):(C(),R(N(lt),{key:1,disabled:P.value||!r.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:Z(()=>[re("span",null,ie(y.text),1)]),content:Z(()=>[re("div",{class:L(N(c).e("collapse-tags"))},[(C(!0),q(ue,null,fe(Y.value.slice(1),(z,oe)=>(C(),q("div",{key:oe,class:L(N(c).e("collapse-tag"))},[(C(),R(N(ct),{key:z.key,class:"in-tooltip",type:r.tagType,size:N(O),hit:z.hitState,closable:z.closable,"disable-transitions":"",onClose:le=>Oe(z)},{default:Z(()=>[re("span",null,ie(z.text),1)]),_:2},1032,["type","size","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","hit","closable","onClose"]))),128)),r.filterable&&!N(p)?he((C(),q("input",{key:0,"onUpdate:modelValue":h[2]||(h[2]=y=>D.value=y),type:"text",class:L(N(c).e("search-input")),placeholder:N(Me)?"":N(S),onInput:h[3]||(h[3]=y=>Fe(D.value,y)),onClick:h[4]||(h[4]=te(y=>ee(!0),["stop"])),onKeydown:Zt(Ot,["delete"]),onCompositionstart:ye,onCompositionupdate:ye,onCompositionend:ye},null,42,es)),[[Yt,D.value]]):J("v-if",!0)],2)):J("v-if",!0)],38)),[[N(Kn),()=>ee(!1),N(nt)]])]),content:Z(()=>[he(X(N(wt),{ref_key:"panel",ref:w,modelValue:N(Ie),"onUpdate:modelValue":h[8]||(h[8]=y=>un(Ie)?Ie.value=y:null),options:r.options,props:a.props,border:!1,"render-label":r.$slots.default,onExpandChange:At,onClose:h[9]||(h[9]=y=>r.$nextTick(()=>ee(!1)))},null,8,["modelValue","options","props","render-label"]),[[we,!H.value]]),r.filterable?he((C(),R(N(Nt),{key:0,ref_key:"suggestionPanel",ref:I,tag:"ul",class:L(N(c).e("suggestion-panel")),"view-class":N(c).e("suggestion-list"),onKeydown:Bt},{default:Z(()=>[k.value.length?(C(!0),q(ue,{key:0},fe(k.value,y=>(C(),q("li",{key:y.uid,class:L([N(c).e("suggestion-item"),N(c).is("checked",y.checked)]),tabindex:-1,onClick:z=>Pt(y)},[re("span",null,ie(y.text),1),y.checked?(C(),R(N(ke),{key:0},{default:Z(()=>[X(N(vt))]),_:1})):J("v-if",!0)],10,ts))),128)):hn(r.$slots,"empty",{key:1},()=>[re("li",{class:L(N(c).e("empty-text"))},ie(N(v)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[we,H.value]]):J("v-if",!0)]),_:3},8,["visible","teleported","popper-class","transition"]))}});var $e=ge(as,[["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader/src/cascader.vue"]]);$e.install=e=>{e.component($e.name,$e)};const os=$e,As=os,me="$treeNodeId",ft=function(e,t){!t||t[me]||Object.defineProperty(t,me,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},tt=function(e,t){return e?t[e]:t[me]},Ye=(e,t,n)=>{const a=e.value.currentNode;n();const s=e.value.currentNode;a!==s&&t("current-change",s?s.data:null,s)},Ge=e=>{let t=!0,n=!0,a=!0;for(let s=0,o=e.length;s<o;s++){const l=e[s];(l.checked!==!0||l.indeterminate)&&(t=!1,l.disabled||(a=!1)),(l.checked!==!1||l.indeterminate)&&(n=!1)}return{all:t,none:n,allWithoutDisable:a,half:!t&&!n}},Te=function(e){if(e.childNodes.length===0||e.loading)return;const{all:t,none:n,half:a}=Ge(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):a?(e.checked=!1,e.indeterminate=!0):n&&(e.checked=!1,e.indeterminate=!1);const s=e.parent;!s||s.level===0||e.store.checkStrictly||Te(s)},De=function(e,t){const n=e.store.props,a=e.data||{},s=n[t];if(typeof s=="function")return s(a,e);if(typeof s=="string")return a[s];if(typeof s>"u"){const o=a[t];return o===void 0?"":o}};let ls=0;class pe{constructor(t){this.id=ls++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const n in t)je(t,n)&&(this[n]=t[n]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const n=t.props;if(n&&typeof n.isLeaf<"u"){const o=De(this,"isLeaf");typeof o=="boolean"&&(this.isLeafByUser=o)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&this.expand(),Array.isArray(this.data)||ft(this,this.data),!this.data)return;const a=t.defaultExpandedKeys,s=t.key;s&&a&&a.includes(this.key)&&this.expand(null,t.autoExpandParent),s&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){Array.isArray(t)||ft(this,t),this.data=t,this.childNodes=[];let n;this.level===0&&Array.isArray(this.data)?n=this.data:n=De(this,"children")||[];for(let a=0,s=n.length;a<s;a++)this.insertChild({data:n[a]})}get label(){return De(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return De(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const n=t.childNodes.indexOf(this);if(n>-1)return t.childNodes[n+1]}return null}get previousSibling(){const t=this.parent;if(t){const n=t.childNodes.indexOf(this);if(n>-1)return n>0?t.childNodes[n-1]:null}return null}contains(t,n=!0){return(this.childNodes||[]).some(a=>a===t||n&&a.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,n,a){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof pe)){if(!a){const s=this.getChildren(!0);s.includes(t.data)||(typeof n>"u"||n<0?s.push(t.data):s.splice(n,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=yt(new pe(t)),t instanceof pe&&t.initialize()}t.level=this.level+1,typeof n>"u"||n<0?this.childNodes.push(t):this.childNodes.splice(n,0,t),this.updateLeafState()}insertBefore(t,n){let a;n&&(a=this.childNodes.indexOf(n)),this.insertChild(t,a)}insertAfter(t,n){let a;n&&(a=this.childNodes.indexOf(n),a!==-1&&(a+=1)),this.insertChild(t,a)}removeChild(t){const n=this.getChildren()||[],a=n.indexOf(t.data);a>-1&&n.splice(a,1);const s=this.childNodes.indexOf(t);s>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(s,1)),this.updateLeafState()}removeChildByData(t){let n=null;for(let a=0;a<this.childNodes.length;a++)if(this.childNodes[a].data===t){n=this.childNodes[a];break}n&&this.removeChild(n)}expand(t,n){const a=()=>{if(n){let s=this.parent;for(;s.level>0;)s.expanded=!0,s=s.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(s=>{s.canFocus=!0})};this.shouldLoadData()?this.loadData(s=>{Array.isArray(s)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||Te(this),a())}):a()}doCreateChildren(t,n={}){t.forEach(a=>{this.insertChild(Object.assign({data:a},n),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const t=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!t||t.length===0;return}this.isLeaf=!1}setChecked(t,n,a,s){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:l,allWithoutDisable:d}=Ge(this.childNodes);!this.isLeaf&&!l&&d&&(this.checked=!1,t=!1);const c=()=>{if(n){const g=this.childNodes;for(let u=0,m=g.length;u<m;u++){const b=g[u];s=s||t!==!1;const A=b.disabled?b.checked:s;b.setChecked(A,n,!0,s)}const{half:v,all:f}=Ge(g);f||(this.checked=f,this.indeterminate=v)}};if(this.shouldLoadData()){this.loadData(()=>{c(),Te(this)},{checked:t!==!1});return}else c()}const o=this.parent;!o||o.level===0||a||Te(o)}getChildren(t=!1){if(this.level===0)return this.data;const n=this.data;if(!n)return null;const a=this.store.props;let s="children";return a&&(s=a.children||"children"),n[s]===void 0&&(n[s]=null),t&&!n[s]&&(n[s]=[]),n[s]}updateChildren(){const t=this.getChildren()||[],n=this.childNodes.map(o=>o.data),a={},s=[];t.forEach((o,l)=>{const d=o[me];!!d&&n.findIndex(g=>g[me]===d)>=0?a[d]={index:l,data:o}:s.push({index:l,data:o})}),this.store.lazy||n.forEach(o=>{a[o[me]]||this.removeChildByData(o)}),s.forEach(({index:o,data:l})=>{this.insertChild({data:l},o)}),this.updateLeafState()}loadData(t,n={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(n).length)){this.loading=!0;const a=s=>{this.childNodes=[],this.doCreateChildren(s,n),this.loaded=!0,this.loading=!1,this.updateLeafState(),t&&t.call(this,s)};this.store.load(this,a)}else t&&t.call(this)}}class rs{constructor(t){this.currentNode=null,this.currentNodeKey=null;for(const n in t)je(t,n)&&(this[n]=t[n]);this.nodesMap={}}initialize(){if(this.root=new pe({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const t=this.load;t(this.root,n=>{this.root.doCreateChildren(n),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(t){const n=this.filterNodeMethod,a=this.lazy,s=function(o){const l=o.root?o.root.childNodes:o.childNodes;if(l.forEach(d=>{d.visible=n.call(d,t,d.data,d),s(d)}),!o.visible&&l.length){let d=!0;d=!l.some(c=>c.visible),o.root?o.root.visible=d===!1:o.visible=d===!1}t&&o.visible&&!o.isLeaf&&!a&&o.expand()};s(this)}setData(t){t!==this.root.data?(this.root.setData(t),this._initDefaultCheckedNodes()):this.root.updateChildren()}getNode(t){if(t instanceof pe)return t;const n=fn(t)?tt(this.key,t):t;return this.nodesMap[n]||null}insertBefore(t,n){const a=this.getNode(n);a.parent.insertBefore({data:t},a)}insertAfter(t,n){const a=this.getNode(n);a.parent.insertAfter({data:t},a)}remove(t){const n=this.getNode(t);n&&n.parent&&(n===this.currentNode&&(this.currentNode=null),n.parent.removeChild(n))}append(t,n){const a=n?this.getNode(n):this.root;a&&a.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],n=this.nodesMap;t.forEach(a=>{const s=n[a];s&&s.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const n=this.key;!t||!t.data||(n?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(a=>{this.deregisterNode(a)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,n=!1){const a=[],s=function(o){(o.root?o.root.childNodes:o.childNodes).forEach(d=>{(d.checked||n&&d.indeterminate)&&(!t||t&&d.isLeaf)&&a.push(d.data),s(d)})};return s(this),a}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(n=>(n||{})[this.key])}getHalfCheckedNodes(){const t=[],n=function(a){(a.root?a.root.childNodes:a.childNodes).forEach(o=>{o.indeterminate&&t.push(o.data),n(o)})};return n(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],n=this.nodesMap;for(const a in n)je(n,a)&&t.push(n[a]);return t}updateChildren(t,n){const a=this.nodesMap[t];if(!a)return;const s=a.childNodes;for(let o=s.length-1;o>=0;o--){const l=s[o];this.remove(l.data)}for(let o=0,l=n.length;o<l;o++){const d=n[o];this.append(d,a.data)}}_setCheckedKeys(t,n=!1,a){const s=this._getAllNodes().sort((d,c)=>c.level-d.level),o=Object.create(null),l=Object.keys(a);s.forEach(d=>d.setChecked(!1,!1));for(let d=0,c=s.length;d<c;d++){const g=s[d],v=g.data[t].toString();if(!l.includes(v)){g.checked&&!o[v]&&g.setChecked(!1,!1);continue}let u=g.parent;for(;u&&u.level>0;)o[u.data[t]]=!0,u=u.parent;if(g.isLeaf||this.checkStrictly){g.setChecked(!0,!1);continue}if(g.setChecked(!0,!0),n){g.setChecked(!1,!1);const m=function(b){b.childNodes.forEach(w=>{w.isLeaf||w.setChecked(!1,!1),m(w)})};m(g)}}}setCheckedNodes(t,n=!1){const a=this.key,s={};t.forEach(o=>{s[(o||{})[a]]=!0}),this._setCheckedKeys(a,n,s)}setCheckedKeys(t,n=!1){this.defaultCheckedKeys=t;const a=this.key,s={};t.forEach(o=>{s[o]=!0}),this._setCheckedKeys(a,n,s)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(n=>{const a=this.getNode(n);a&&a.expand(null,this.autoExpandParent)})}setChecked(t,n,a){const s=this.getNode(t);s&&s.setChecked(!!n,a)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const n=this.currentNode;n&&(n.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,n=!0){const a=t[this.key],s=this.nodesMap[a];this.setCurrentNode(s),n&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,n=!0){if(t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const a=this.getNode(t);a&&(this.setCurrentNode(a),n&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const ds=de({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=ae("tree"),n=ve("NodeInstance"),a=ve("RootTree");return()=>{const s=e.node,{data:o,store:l}=s;return e.renderContent?e.renderContent(qe,{_self:n,node:s,data:o,store:l}):a.ctx.slots.default?a.ctx.slots.default({node:s,data:o}):qe("span",{class:t.be("node","label")},[s.label])}}});var is=ge(ds,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree-node-content.vue"]]);function Dt(e){const t=ve("TreeNodeMap",null),n={treeNodeExpand:a=>{e.node!==a&&e.node.collapse()},children:[]};return t&&t.children.push(n),Ne("TreeNodeMap",n),{broadcastExpanded:a=>{if(e.accordion)for(const s of n.children)s.treeNodeExpand(a)}}}const St=Symbol("dragEvents");function cs({props:e,ctx:t,el$:n,dropIndicator$:a,store:s}){const o=ae("tree"),l=$({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return Ne(St,{treeNodeDragStart:({event:v,treeNode:f})=>{if(typeof e.allowDrag=="function"&&!e.allowDrag(f.node))return v.preventDefault(),!1;v.dataTransfer.effectAllowed="move";try{v.dataTransfer.setData("text/plain","")}catch{}l.value.draggingNode=f,t.emit("node-drag-start",f.node,v)},treeNodeDragOver:({event:v,treeNode:f})=>{const u=f,m=l.value.dropNode;m&&m!==u&&Ve(m.$el,o.is("drop-inner"));const b=l.value.draggingNode;if(!b||!u)return;let A=!0,w=!0,I=!0,P=!0;typeof e.allowDrop=="function"&&(A=e.allowDrop(b.node,u.node,"prev"),P=w=e.allowDrop(b.node,u.node,"inner"),I=e.allowDrop(b.node,u.node,"next")),v.dataTransfer.dropEffect=w||A||I?"move":"none",(A||w||I)&&m!==u&&(m&&t.emit("node-drag-leave",b.node,m.node,v),t.emit("node-drag-enter",b.node,u.node,v)),(A||w||I)&&(l.value.dropNode=u),u.node.nextSibling===b.node&&(I=!1),u.node.previousSibling===b.node&&(A=!1),u.node.contains(b.node,!1)&&(w=!1),(b.node===u.node||b.node.contains(u.node))&&(A=!1,w=!1,I=!1);const W=u.$el.getBoundingClientRect(),H=n.value.getBoundingClientRect();let M;const D=A?w?.25:I?.45:1:-1,F=I?w?.75:A?.55:0:1;let Y=-9999;const k=v.clientY-W.top;k<W.height*D?M="before":k>W.height*F?M="after":w?M="inner":M="none";const B=u.$el.querySelector(`.${o.be("node","expand-icon")}`).getBoundingClientRect(),j=a.value;M==="before"?Y=B.top-H.top:M==="after"&&(Y=B.bottom-H.top),j.style.top=`${Y}px`,j.style.left=`${B.right-H.left}px`,M==="inner"?pn(u.$el,o.is("drop-inner")):Ve(u.$el,o.is("drop-inner")),l.value.showDropIndicator=M==="before"||M==="after",l.value.allowDrop=l.value.showDropIndicator||P,l.value.dropType=M,t.emit("node-drag-over",b.node,u.node,v)},treeNodeDragEnd:v=>{const{draggingNode:f,dropType:u,dropNode:m}=l.value;if(v.preventDefault(),v.dataTransfer.dropEffect="move",f&&m){const b={data:f.node.data};u!=="none"&&f.node.remove(),u==="before"?m.node.parent.insertBefore(b,m.node):u==="after"?m.node.parent.insertAfter(b,m.node):u==="inner"&&m.node.insertChild(b),u!=="none"&&s.value.registerNode(b),Ve(m.$el,o.is("drop-inner")),t.emit("node-drag-end",f.node,m.node,u,v),u!=="none"&&t.emit("node-drop",f.node,m.node,u,v)}f&&!m&&t.emit("node-drag-end",f.node,null,u,v),l.value.showDropIndicator=!1,l.value.draggingNode=null,l.value.dropNode=null,l.value.allowDrop=!0}}),{dragState:l}}const us=de({name:"ElTreeNode",components:{ElCollapseTransition:$n,ElCheckbox:Ct,NodeContent:is,ElIcon:ke,Loading:Je},props:{node:{type:pe,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const n=ae("tree"),{broadcastExpanded:a}=Dt(e),s=ve("RootTree"),o=$(!1),l=$(!1),d=$(null),c=$(null),g=$(null),v=ve(St),f=Qe();Ne("NodeInstance",f),e.node.expanded&&(o.value=!0,l.value=!0);const u=s.props.children||"children";_(()=>{const k=e.node.data[u];return k&&[...k]},()=>{e.node.updateChildren()}),_(()=>e.node.indeterminate,k=>{A(e.node.checked,k)}),_(()=>e.node.checked,k=>{A(k,e.node.indeterminate)}),_(()=>e.node.expanded,k=>{ce(()=>o.value=k),k&&(l.value=!0)});const m=k=>tt(s.props.nodeKey,k.data),b=k=>{const B=e.props.class;if(!B)return{};let j;if(Re(B)){const{data:p}=k;j=B(p,k)}else j=B;return gn(j)?{[j]:!0}:j},A=(k,B)=>{(d.value!==k||c.value!==B)&&s.ctx.emit("check-change",e.node.data,k,B),d.value=k,c.value=B},w=k=>{Ye(s.store,s.ctx.emit,()=>s.store.value.setCurrentNode(e.node)),s.currentNode.value=e.node,s.props.expandOnClickNode&&P(),s.props.checkOnClickNode&&!e.node.disabled&&W(null,{target:{checked:!e.node.checked}}),s.ctx.emit("node-click",e.node.data,e.node,f,k)},I=k=>{s.instance.vnode.props.onNodeContextmenu&&(k.stopPropagation(),k.preventDefault()),s.ctx.emit("node-contextmenu",k,e.node.data,e.node,f)},P=()=>{e.node.isLeaf||(o.value?(s.ctx.emit("node-collapse",e.node.data,e.node,f),e.node.collapse()):(e.node.expand(),t.emit("node-expand",e.node.data,e.node,f)))},W=(k,B)=>{e.node.setChecked(B.target.checked,!s.props.checkStrictly),ce(()=>{const j=s.store.value;s.ctx.emit("check",e.node.data,{checkedNodes:j.getCheckedNodes(),checkedKeys:j.getCheckedKeys(),halfCheckedNodes:j.getHalfCheckedNodes(),halfCheckedKeys:j.getHalfCheckedKeys()})})};return{ns:n,node$:g,tree:s,expanded:o,childNodeRendered:l,oldChecked:d,oldIndeterminate:c,getNodeKey:m,getNodeClass:b,handleSelectChange:A,handleClick:w,handleContextMenu:I,handleExpandIconClick:P,handleCheckChange:W,handleChildNodeExpand:(k,B,j)=>{a(B),s.ctx.emit("node-expand",k,B,j)},handleDragStart:k=>{s.props.draggable&&v.treeNodeDragStart({event:k,treeNode:e})},handleDragOver:k=>{k.preventDefault(),s.props.draggable&&v.treeNodeDragOver({event:k,treeNode:{$el:g.value,node:e.node}})},handleDrop:k=>{k.preventDefault()},handleDragEnd:k=>{s.props.draggable&&v.treeNodeDragEnd(k)},CaretRight:vn}}}),hs=["aria-expanded","aria-disabled","aria-checked","draggable","data-key"],fs=["aria-expanded"];function ps(e,t,n,a,s,o){const l=G("el-icon"),d=G("el-checkbox"),c=G("loading"),g=G("node-content"),v=G("el-tree-node"),f=G("el-collapse-transition");return he((C(),q("div",{ref:"node$",class:L([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:t[1]||(t[1]=te((...u)=>e.handleClick&&e.handleClick(...u),["stop"])),onContextmenu:t[2]||(t[2]=(...u)=>e.handleContextMenu&&e.handleContextMenu(...u)),onDragstart:t[3]||(t[3]=te((...u)=>e.handleDragStart&&e.handleDragStart(...u),["stop"])),onDragover:t[4]||(t[4]=te((...u)=>e.handleDragOver&&e.handleDragOver(...u),["stop"])),onDragend:t[5]||(t[5]=te((...u)=>e.handleDragEnd&&e.handleDragEnd(...u),["stop"])),onDrop:t[6]||(t[6]=te((...u)=>e.handleDrop&&e.handleDrop(...u),["stop"]))},[re("div",{class:L(e.ns.be("node","content")),style:mt({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(C(),R(l,{key:0,class:L([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:te(e.handleExpandIconClick,["stop"])},{default:Z(()=>[(C(),R(yn(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):J("v-if",!0),e.showCheckbox?(C(),R(d,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:t[0]||(t[0]=te(()=>{},["stop"])),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onChange"])):J("v-if",!0),e.node.loading?(C(),R(l,{key:2,class:L([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:Z(()=>[X(c)]),_:1},8,["class"])):J("v-if",!0),X(g,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),X(f,null,{default:Z(()=>[!e.renderAfterExpand||e.childNodeRendered?he((C(),q("div",{key:0,class:L(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(C(!0),q(ue,null,fe(e.node.childNodes,u=>(C(),R(v,{key:e.getNodeKey(u),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:u,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,fs)),[[we,e.expanded]]):J("v-if",!0)]),_:1})],42,hs)),[[we,e.node.visible]])}var vs=ge(us,[["render",ps],["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree-node.vue"]]);function gs({el$:e},t){const n=ae("tree"),a=ot([]),s=ot([]);Xe(()=>{l()}),kn(()=>{a.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),s.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),_(s,d=>{d.forEach(c=>{c.setAttribute("tabindex","-1")})}),_t(e,"keydown",d=>{const c=d.target;if(!c.className.includes(n.b("node")))return;const g=d.code;a.value=Array.from(e.value.querySelectorAll(`.${n.is("focusable")}[role=treeitem]`));const v=a.value.indexOf(c);let f;if([U.up,U.down].includes(g)){if(d.preventDefault(),g===U.up){f=v===-1?0:v!==0?v-1:a.value.length-1;const m=f;for(;!t.value.getNode(a.value[f].dataset.key).canFocus;){if(f--,f===m){f=-1;break}f<0&&(f=a.value.length-1)}}else{f=v===-1?0:v<a.value.length-1?v+1:0;const m=f;for(;!t.value.getNode(a.value[f].dataset.key).canFocus;){if(f++,f===m){f=-1;break}f>=a.value.length&&(f=0)}}f!==-1&&a.value[f].focus()}[U.left,U.right].includes(g)&&(d.preventDefault(),c.click());const u=c.querySelector('[type="checkbox"]');[U.enter,U.space].includes(g)&&u&&(d.preventDefault(),u.click())});const l=()=>{var d;a.value=Array.from(e.value.querySelectorAll(`.${n.is("focusable")}[role=treeitem]`)),s.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const c=e.value.querySelectorAll(`.${n.is("checked")}[role=treeitem]`);if(c.length){c[0].setAttribute("tabindex","0");return}(d=a.value[0])==null||d.setAttribute("tabindex","0")}}const ys=de({name:"ElTree",components:{ElTreeNode:vs},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:mn}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:n}=_e(),a=ae("tree"),s=$(new rs({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));s.value.initialize();const o=$(s.value.root),l=$(null),d=$(null),c=$(null),{broadcastExpanded:g}=Dt(e),{dragState:v}=cs({props:e,ctx:t,el$:d,dropIndicator$:c,store:s});gs({el$:d},s);const f=T(()=>{const{childNodes:i}=o.value;return!i||i.length===0||i.every(({visible:E})=>!E)});_(()=>e.currentNodeKey,i=>{s.value.setCurrentNodeKey(i)}),_(()=>e.defaultCheckedKeys,i=>{s.value.setDefaultCheckedKey(i)}),_(()=>e.defaultExpandedKeys,i=>{s.value.setDefaultExpandedKeys(i)}),_(()=>e.data,i=>{s.value.setData(i)},{deep:!0}),_(()=>e.checkStrictly,i=>{s.value.checkStrictly=i});const u=i=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");s.value.filter(i)},m=i=>tt(e.nodeKey,i.data),b=i=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const E=s.value.getNode(i);if(!E)return[];const V=[E.data];let Q=E.parent;for(;Q&&Q!==o.value;)V.push(Q.data),Q=Q.parent;return V.reverse()},A=(i,E)=>s.value.getCheckedNodes(i,E),w=i=>s.value.getCheckedKeys(i),I=()=>{const i=s.value.getCurrentNode();return i?i.data:null},P=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const i=I();return i?i[e.nodeKey]:null},W=(i,E)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");s.value.setCheckedNodes(i,E)},H=(i,E)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");s.value.setCheckedKeys(i,E)},M=(i,E,V)=>{s.value.setChecked(i,E,V)},D=()=>s.value.getHalfCheckedNodes(),F=()=>s.value.getHalfCheckedKeys(),Y=(i,E=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");Ye(s,t.emit,()=>s.value.setUserCurrentNode(i,E))},k=(i,E=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");Ye(s,t.emit,()=>s.value.setCurrentNodeKey(i,E))},B=i=>s.value.getNode(i),j=i=>{s.value.remove(i)},p=(i,E)=>{s.value.append(i,E)},S=(i,E)=>{s.value.insertBefore(i,E)},K=(i,E)=>{s.value.insertAfter(i,E)},x=(i,E,V)=>{g(E),t.emit("node-expand",i,E,V)},O=(i,E)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");s.value.updateChildren(i,E)};return Ne("RootTree",{ctx:t,props:e,store:s,root:o,currentNode:l,instance:Qe()}),Ne(Nn,void 0),{ns:a,store:s,root:o,currentNode:l,dragState:v,el$:d,dropIndicator$:c,isEmpty:f,filter:u,getNodeKey:m,getNodePath:b,getCheckedNodes:A,getCheckedKeys:w,getCurrentNode:I,getCurrentKey:P,setCheckedNodes:W,setCheckedKeys:H,setChecked:M,getHalfCheckedNodes:D,getHalfCheckedKeys:F,setCurrentNode:Y,setCurrentKey:k,t:n,getNode:B,remove:j,append:p,insertBefore:S,insertAfter:K,handleNodeExpand:x,updateKeyChildren:O}}});function ks(e,t,n,a,s,o){var l;const d=G("el-tree-node");return C(),q("div",{ref:"el$",class:L([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(C(!0),q(ue,null,fe(e.root.childNodes,c=>(C(),R(d,{key:e.getNodeKey(c),node:c,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(C(),q("div",{key:0,class:L(e.ns.e("empty-block"))},[re("span",{class:L(e.ns.e("empty-text"))},ie((l=e.emptyText)!=null?l:e.t("el.tree.emptyText")),3)],2)):J("v-if",!0),he(re("div",{ref:"dropIndicator$",class:L(e.ns.e("drop-indicator"))},null,2),[[we,e.dragState.showDropIndicator]])],2)}var Le=ge(ys,[["render",ks],["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree.vue"]]);Le.install=e=>{e.component(Le.name,Le)};const ms=Le,Ms=ms;export{As as E,ms as _,xs as a,Ms as b,Mn as g};
