/* empty css             *//* empty css                  */import"./el-form-item-4ed993c7.js";/* empty css                 *//* empty css               *//* empty css                   */import{_ as Ve}from"./formDrawer-615cee08.js";/* empty css                *//* empty css                      *//* empty css                        *//* empty css                    *//* empty css                        *//* empty css                  *//* empty css                       *//* empty css                *//* empty css                    */import{v as O,F as ae,B as Ee,E as we}from"./msgTip-a00a6396.js";import{t as De}from"./tableHeader-f66fb168.js";import{b as U,E as Se}from"./index-7aff1b23.js";import{q as re}from"./queryParams-4c57c9da.js";import{u as Re,a as Be}from"./useCommon-3fca7f65.js";import{_ as Oe}from"./_plugin-vue_export-helper-c27b6911.js";import{v as Ie,a as Te,E as Ue}from"./directive-7bc345b5.js";import{a as ze,E as Ae}from"./index-3276a6b0.js";import{r as C,o as $e,av as J,m as i,n as x,K as o,C as l,J as I,R as T,u as n,q as e,D as E,H as b,I as r,B as y,G as F,E as Fe,a7 as Me,cG as Le,cH as Ne}from"./index-d45ed081.js";import{a as Pe}from"./index-6998b886.js";import{E as Ye}from"./index-cd6b903f.js";import{a as He,E as qe}from"./index-4bd039ef.js";import{E as Ge}from"./index-d6a34864.js";import{E as Xe}from"./index-151d4a8e.js";import{E as je}from"./index-61f461ba.js";import{a as Je}from"./index-ae57328d.js";import"./index-1cb0abaf.js";/* empty css                   */import"./index-c440b37e.js";import"./js.cookie-cf83ad76.js";import"./strings-5238cde9.js";import"./index-184e15d9.js";import"./_initCloneObject-4b55852b.js";import"./index-b06f2c24.js";import"./arrays-e667dc24.js";import"./index-ebc90b42.js";function Ke(d,m={}){let k=re(m);return U.get(`/order/${d}${k}`)}const Qe=function(d){return d=Array.isArray(d)?d:[d],U.post("/order/delete_all",{ids:d})},We=(d,m)=>U({url:`/order/${d}/ship`,method:"post",data:m}),se=(d,{agree:m,disagree_reason:k})=>U({url:`/order/${d}/handle_refund`,method:"post",data:{agree:m,disagree_reason:k}});function Ze(d={}){let m=re(d);return U.post(`/order/excelexport${m}`,{},{responseType:"blob"})}const et=()=>U({url:"/express_company/1",method:"get"});function tt(d){var m=new Date(d),k=m.getFullYear(),h=m.getMonth()+1,w=m.getDate(),D=m.getHours(),S=m.getMinutes(),s=m.getSeconds();h<10&&(h="0"+h),w<10&&(w="0"+w),D<10&&(D="0"+D),S<10&&(S="0"+S),s<10&&(s="0"+s);var M=k+"-"+h+"-"+w+" "+D+":"+S+":"+s;return console.log(M),M}const c=d=>(Le("data-v-ed05c872"),d=d(),Ne(),d),ot={class:"search-item"},lt={class:"search-input"},nt={class:"btn"},at={class:"order-first"},st=c(()=>e("p",null,"订单号:",-1)),rt={style:{padding:"4px 0"}},dt={style:{display:"flex","align-items":"center","margin-bottom":"5px"}},it={style:{color:"#4338ca"}},ct={style:{display:"flex","flex-direction":"column","align-items":"center"}},ut={class:"buy_status"},_t=c(()=>e("h4",null,"付款状态",-1)),pt=c(()=>e("h4",null,"发货状态",-1)),mt=c(()=>e("h4",null,"收获状态",-1)),ht=c(()=>e("div",{class:"card-header"},[e("span",null,"订单信息")],-1)),ft={class:"order-info"},vt=c(()=>e("div",{class:"l-content"},"订单号",-1)),yt={class:"r-content"},gt={class:"order-info"},bt=c(()=>e("div",{class:"l-content"},"付款方式",-1)),xt={class:"r-content"},kt={class:"order-info"},Ct=c(()=>e("div",{class:"l-content"},"创建时间",-1)),Vt={class:"r-content"},Et={class:"order-info"},wt=c(()=>e("div",{class:"l-content"},"付款时间",-1)),Dt={class:"r-content"},St=c(()=>e("div",{class:"card-header"},[e("span",null,"发货信息")],-1)),Rt={class:"order-info"},Bt=c(()=>e("div",{class:"l-content"},"物流公司",-1)),Ot={class:"r-content"},It={class:"order-info"},Tt=c(()=>e("div",{class:"l-content"},"运单号",-1)),Ut={class:"r-content"},zt={class:"order-info"},At=c(()=>e("div",{class:"l-content"},"发货时间",-1)),$t={class:"r-content"},Ft=c(()=>e("div",{class:"card-header"},[e("span",null,"商品信息")],-1)),Mt={class:"goods-info"},Lt={class:"info-item"},Nt={class:"text-info"},Pt=c(()=>e("small",null,"x1",-1)),Yt={class:"already"},Ht=c(()=>e("p",null,"成交价",-1)),qt=c(()=>e("div",{class:"card-header"},[e("span",null,"收货信息")],-1)),Gt={class:"order-info"},Xt=c(()=>e("div",{class:"l-content"},"收货人",-1)),jt={class:"r-content"},Jt={class:"order-info"},Kt=c(()=>e("div",{class:"l-content"},"联系方式",-1)),Qt={class:"r-content"},Wt={class:"order-info"},Zt=c(()=>e("div",{class:"l-content"},"收获地址",-1)),eo={class:"r-content"},to=["model"],oo=["model"],lo={__name:"list",setup(d){const m=[{key:"all",name:"全部"},{key:"nopay",name:"待支付"},{key:"noship",name:"待发货"},{key:"shiped",name:"待收货"},{key:"received",name:"已收货"},{key:"finish",name:"已完成"},{key:"closed",name:"已关闭"},{key:"refunding",name:"退款中"}],k=C([]),h=C(!0),{loading:w,tableData:D,total:S,searchForm:s,changePage:M,getData:f,handleDel:de}=Re({searchForm:{tab:"all",no:"",starttime:"",endtime:"",name:"",phone:""},del:Qe,getList:Ke}),{formDrawerRef:no,formRef:K,Form:u,onSubmit:ie}=Be({Form:{express_company:"",express_no:"",tab:"",starttime:"",endtime:"",FormArr:null},getData:f}),ce=p=>{k.value=p.map(a=>a.id)},ue=()=>{s.no="",s.tab="",s.starttime="",s.endtime="",s.name="",s.phone="",f()},Q=(p,a)=>{a==1?se(p,{agree:a}).then(g=>{ae("操作成功",2e3,"success"),f()}):_e(p,a)},_e=(p,a)=>{Ee.prompt("请输入拒绝理由",{confirmButtonText:"确认",cancelButtonText:"取消"}).then(({value:g})=>{se(p,{agree:a,disagree_reason:g}).then(H=>{console.log(H)}),ae("操作成功",2e3,"info")})},W=C(null),_=C([]),pe=p=>{_.value=p,console.log(_.value),W.value.open()},Y=C(null),Z=C([]),ee=C(0),me=p=>{ee.value=p.id,et().then(a=>{Z.value=a.data.list}),Y.value.open()},he=()=>{let p={express_company:u.value.express_company,express_no:u.value.express_no};We(ee.value,p).then(a=>{f(),Y.value.close()})},te=C(null),fe=()=>{te.value.open()},ve=()=>{if(u.timeArr){let p=u.value.timeArr.slice(",");u.value.starttime=p[0],u.value.endtime=p[1]}Ze(u.value.tab,u.value.starttime,u.value.endtime).then(p=>{let a=window.URL.createObjectURL(new Blob([p])),g=document.createElement("a");g.style.display="none",g.href=a;let L=new Date().getTime()+".xlsx";g.setAttribute("download",L),document.body.appendChild(g),g.click(),close()})};return $e(()=>{f()}),(p,a)=>{const g=ze,L=Ae,H=J("Download"),q=Fe,ye=Pe,N=we,G=Ye,R=Me,ge=J("ArrowDownBold"),be=J("ArrowUpBold"),V=He,oe=Ge,B=Xe,xe=qe,ke=je,z=Se,X=Ve,le=Te,ne=Ue,P=Je,Ce=Ie;return i(),x("div",null,[o(L,{modelValue:n(s).tab,"onUpdate:modelValue":a[0]||(a[0]=t=>n(s).tab=t),onTabChange:n(f)},{default:l(()=>[(i(),x(I,null,T(m,(t,v)=>o(g,{label:t.name,name:t.key,key:v},null,8,["label","name"])),64))]),_:1},8,["modelValue","onTabChange"]),o(z,{shadow:"always"},{default:l(()=>[o(ye,{effect:"dark",content:"导出订单",placement:"bottom"},{default:l(()=>[o(q,{class:"export-btn",onClick:fe},{default:l(()=>[o(H)]),_:1})]),_:1}),e("div",ot,[e("div",lt,[o(N,{size:"small","prefix-icon":"Search",modelValue:n(s).no,"onUpdate:modelValue":a[1]||(a[1]=t=>n(s).no=t),placeholder:"订单编号",clearable:"",onChange:n(f)},null,8,["modelValue","onChange"]),E(o(N,{size:"small","prefix-icon":"Search",modelValue:n(s).name,"onUpdate:modelValue":a[2]||(a[2]=t=>n(s).name=t),placeholder:"收货人",clearable:"",onChange:n(f)},null,8,["modelValue","onChange"]),[[O,!h.value]]),E(o(N,{size:"small","prefix-icon":"Search",modelValue:n(s).phone,"onUpdate:modelValue":a[3]||(a[3]=t=>n(s).phone=t),placeholder:"手机号",clearable:"",onChange:n(f)},null,8,["modelValue","onChange"]),[[O,!h.value]]),E(e("span",null,[o(G,{size:"small",modelValue:n(s).starttime,"onUpdate:modelValue":a[4]||(a[4]=t=>n(s).starttime=t),type:"date",placeholder:"开始日期",onChange:n(f)},null,8,["modelValue","onChange"])],512),[[O,!h.value]]),E(e("span",null,[o(G,{size:"small",modelValue:n(s).endtime,"onUpdate:modelValue":a[5]||(a[5]=t=>n(s).endtime=t),type:"date",placeholder:"结束日期",onChange:n(f)},null,8,["modelValue","onChange"])],512),[[O,!h.value]])]),e("div",nt,[o(R,{size:"small",onClick:ue,plain:""},{default:l(()=>[b("清空")]),_:1}),o(R,{class:"type-btn",link:"",type:"primary",onClick:a[6]||(a[6]=t=>h.value=!h.value)},{default:l(()=>[e("p",null,r(h.value?"展开":"收起"),1),E(o(q,null,{default:l(()=>[o(ge)]),_:1},512),[[O,h.value]]),E(o(q,null,{default:l(()=>[o(be)]),_:1},512),[[O,!h.value]])]),_:1})])]),o(De,{layout:"delete,refresh",onDelete:a[7]||(a[7]=t=>n(de)(k.value)),onRefresh:n(f)},null,8,["onRefresh"]),E((i(),y(xe,{"max-height":"480px",data:n(D),stripe:"",style:{width:"100%"},onSelectionChange:ce},{default:l(()=>[o(V,{type:"selection"}),o(V,{prop:"name",label:"商品",width:"230"},{default:l(({row:t})=>[e("div",at,[st,e("small",rt,r(t.no),1),(i(!0),x(I,null,T(t.order_items,v=>{var A,$;return i(),x("div",dt,[o(oe,{style:{width:"40px",height:"40px","margin-right":"10px"},src:((A=v.goods_item)==null?void 0:A.cover)??"",fit:"cover"},null,8,["src"]),e("p",it,r((($=v.goods_item)==null?void 0:$.title)??"XX商品"),1)])}),256))])]),_:1}),o(V,{prop:"create_time",label:"下单时间",width:"180"}),o(V,{prop:"total_price",label:"实付款",width:"120",align:"center"}),o(V,{prop:"order",label:"买家",width:"150",align:"center"},{default:l(({row:t})=>[e("div",ct,[e("span",null,r(t.user.username),1),e("small",null,"（用户ID: "+r(t.user.id)+"）",1)])]),_:1}),o(V,{prop:"order",label:"交易状态",width:"150",align:"center"},{default:l(({row:t})=>[e("div",ut,[e("div",null,[_t,e("div",null,[t.payment_method=="wechat"?(i(),y(B,{key:0,size:"small"},{default:l(()=>[b("微信支付")]),_:1})):t.payment_method=="alipay"?(i(),y(B,{key:1,size:"small"},{default:l(()=>[b("支付宝支付")]),_:1})):(i(),y(B,{key:2,type:"info",size:"small"},{default:l(()=>[b("未支付")]),_:1}))])]),e("div",null,[pt,o(B,{type:t.ship_data?"success":"info"},{default:l(()=>[b(r(t.ship_data?"已发货":"未发货"),1)]),_:2},1032,["type"])]),e("div",null,[mt,o(B,{type:t.ship_status=="received"?"success":"info"},{default:l(()=>[b(r(t.ship_status=="received"?"已收货":"未收货"),1)]),_:2},1032,["type"])])])]),_:1}),o(V,{fixed:"right",label:"操作",width:"auto",align:"center"},{default:l(({row:t})=>[o(R,{link:"",type:"primary",size:"small",onClick:v=>pe(t)},{default:l(()=>[b("订单详情")]),_:2},1032,["onClick"]),t.payment_method!=null&&n(s).tab!="refunding"?(i(),y(R,{key:0,link:"",type:"primary",size:"small",onClick:v=>me(t)},{default:l(()=>[b("订单发货")]),_:2},1032,["onClick"])):F("",!0),n(s).tab=="refunding"?(i(),y(R,{key:1,link:"",type:"primary",size:"small",onClick:v=>Q(t.id,1)},{default:l(()=>[b("同意退款")]),_:2},1032,["onClick"])):F("",!0),n(s).tab=="refunding"?(i(),y(R,{key:2,link:"",type:"primary",size:"small",onClick:v=>Q(t.id,0)},{default:l(()=>[b("拒绝退款")]),_:2},1032,["onClick"])):F("",!0)]),_:1})]),_:1},8,["data"])),[[Ce,n(w)]]),o(ke,{small:"",background:"",layout:"prev, pager, next",total:n(S),onCurrentChange:n(M)},null,8,["total","onCurrentChange"])]),_:1}),o(X,{class:"form-drawer",ref_key:"orderDetailRef",ref:W,title:"订单详情",destroyOnClose:"",onSubmit:n(ie)},{default:l(()=>[o(z,{shadow:"never"},{header:l(()=>[ht]),default:l(()=>[e("div",ft,[vt,e("div",yt,r(_.value.payment_no),1)]),e("div",gt,[bt,e("div",xt,r(_.value.payment_method=="alipay"?"支付宝":"微信"),1)]),e("div",kt,[Ct,e("div",Vt,r(_.value.create_time),1)]),e("div",Et,[wt,e("div",Dt,r(_.value.update_time),1)])]),_:1}),_.value.ship_data?(i(),y(z,{key:0,shadow:"never"},{header:l(()=>[St]),default:l(()=>[e("div",Rt,[Bt,e("div",Ot,r(_.value.ship_data.express_company),1)]),e("div",It,[Tt,e("div",Ut,r(_.value.ship_data.express_no),1)]),e("div",zt,[At,e("div",$t,r(n(tt)(Number(_.value.ship_data.express_time))),1)])]),_:1})):F("",!0),_.value.order_items?(i(),y(z,{key:1,shadow:"never"},{header:l(()=>[Ft]),default:l(()=>[e("div",Mt,[(i(!0),x(I,null,T(_.value.order_items,t=>{var v,A,$;return i(),x("div",{key:t.id},[e("div",Lt,[o(oe,{src:((v=t.goods_item)==null?void 0:v.cover)??"",fit:"cover"},null,8,["src"]),e("div",Nt,[e("p",null,r(((A=t.goods_item)==null?void 0:A.title)??"商品已下架"),1),(i(!0),x(I,null,T((($=t.goods_skus)==null?void 0:$.skus)??[],j=>(i(),y(B,{type:"info",key:j.id},{default:l(()=>[e("span",null,r(j.name)+" : "+r(j.text),1)]),_:2},1024))),128)),e("div",null,[e("span",null,"￥ "+r(t.price),1),Pt])])]),e("div",Yt,[Ht,e("span",null,"￥ "+r(t.price),1)])])}),128))])]),_:1})):F("",!0),o(z,{shadow:"never"},{header:l(()=>[qt]),default:l(()=>[e("div",Gt,[Xt,e("div",jt,r(_.value.address.name),1)]),e("div",Jt,[Kt,e("div",Qt,r(_.value.address.phone),1)]),e("div",Wt,[Zt,e("div",eo,r(_.value.address.province)+r(_.value.address.city)+r(_.value.address.district)+r(_.value.address.address),1)])]),_:1})]),_:1},8,["onSubmit"]),o(X,{ref_key:"orderSendRef",ref:Y,title:"订单发货",destroyOnClose:"","confirm-text":"提交",onSubmit:he},{default:l(()=>[e("form",{ref_key:"formRef",ref:K,model:n(u),"status-icon":"","label-width":"auto"},[o(P,{label:"物流公司"},{default:l(()=>[o(ne,{modelValue:n(u).express_company,"onUpdate:modelValue":a[8]||(a[8]=t=>n(u).express_company=t),placeholder:"请选择"},{default:l(()=>[(i(!0),x(I,null,T(Z.value,t=>(i(),y(le,{key:t.code,label:t.name,value:t.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(P,{label:"快递单号"},{default:l(()=>[o(N,{modelValue:n(u).express_no,"onUpdate:modelValue":a[9]||(a[9]=t=>n(u).express_no=t)},null,8,["modelValue"])]),_:1})],8,to)]),_:1},512),o(X,{ref_key:"exportOrderRef",ref:te,title:"导出订单",destroyOnClose:"","confirm-text":"导出",onSubmit:ve},{default:l(()=>[e("form",{ref_key:"formRef",ref:K,model:n(u),"status-icon":"","label-width":"auto"},[o(P,{label:"订单类型"},{default:l(()=>[o(ne,{modelValue:n(u).express_company,"onUpdate:modelValue":a[10]||(a[10]=t=>n(u).express_company=t),placeholder:"请选择"},{default:l(()=>[(i(),x(I,null,T(m,t=>o(le,{key:t.key,label:t.name,value:t.key},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(P,{label:"时间范围"},{default:l(()=>[o(G,{modelValue:n(u).timeArr,"onUpdate:modelValue":a[11]||(a[11]=t=>n(u).timeArr=t),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})],8,oo)]),_:1},512)])}}},jo=Oe(lo,[["__scopeId","data-v-ed05c872"]]);export{jo as default};
